# -*- coding: utf-8 -*-
"""
Created on Fri Oct 17 17:59:17 2014

@author: clark
"""

import dicom

import matplotlib.pyplot as plt
import numpy as np
from scipy import ndimage
import Image
from scipy.optimize.minpack import curve_fit

def plot(data, title):
    plot.i += 1
    plt.subplot(2,6,plot.i)
    plt.imshow(data)
    plt.gray()
    plt.title(title)
plot.i = 0



Acqtime = np.zeros(11)
Invtime = np.zeros(11)
Ttop = [0.12, 0.22, 0.37]



 

    
x = [14,28,42,56,70,84,98,112,126,140,154,168,182,196,210,224,238,252,266,280,294,308,322,336,350,364,378,392,406,420,434,448]
print x
#y=[1801.5,1884.9,1518.6,1382.1,1161.9,1045.8,884.4,795.1,673.3,606.7,512.9,463.5,390.7,354.7,298.2,271.6,228.2,208.3,175.0,160.0,134.6,123.2,103.8,94.8,80.1,73.1,61.9,56.6,48.1,43.9,37.3,34.2]
#y=[1099.8,989.9,657.3,526.2,358.0,291.1,194.4,163.4,105.8,93.1,58.0,54.0,32.3,31.9,18.0,19.3,10.3,12.1,6.2,7.7,3.6,5.0,2.4,3.4,1.7,2.6,1.5,2.0,1.2,1.7,1.2,1.3]
#y=[243.2,190.6,85.0,63.8,27.7,23.5,8.5,9.2,2.3,4.0,1.1,2.0,0.9,1.2,0.9,1.2,0.9,0.9,1.0,1.0,0.9,1.0,1.0,0.7,0.9,1.0,0.9,0.9,0.9,0.9,0.8,0.9]
#y=[1066.3,716.8,279.6,189.6,62.2,60.0,11.7,22.0,2.8,10.0,2.9,5.6,2.5,3.2,1.8,2.1,1.6,1.5,1.4,1.2,1.0,1.2,1.0,1.1,1.2,1.1,1.1,1.0,1.0,1.0,1.0,1.0]
#y=[648.6,390.4,127.6,84.2,19.8,23.6,2.7,8.6,2.1,3.9,1.7,2.4,1.4,1.5,1.2,1.1,1.1,1.1,1.0,0.9,0.9,0.9,0.9,0.8,0.9,0.9,0.8,1.0,0.9,1.0,0.8,0.8]
y=[129.0,72.6,13.2,12.1,1.7,3.1,1.1,1.4,0.9,0.9,0.9,0.9,1.0,0.8,0.9,0.9,0.9,0.9,1.0,1.0,0.8,0.7,0.9,0.9,0.9,0.9,0.9,0.9,0.8,0.9,0.9,0.9]


print y
smoothx = np.linspace(x[0], x[-1], 1000)



guess_a, guess_b = max(y), 200
guess = [guess_a, guess_b]
exp_f = lambda x, X0, T2:(X0*(np.exp(-x/T2)))

params, cov = curve_fit(exp_f, x, y, p0=guess)

X0, T2 = params

best_fit = lambda x: (X0*(np.exp(-x/T2)))

fitted_y=exp_f(smoothx, X0,  T2)






print X0

print T2

        


plt.figure(2)
plt.plot(x, y, 'o')

xxx = np.linspace(np.min(x), np.max(x), 1000)
plt.plot(xxx,exp_f(smoothx, X0,T2))